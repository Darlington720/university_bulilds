import{r as t,j as l,s as S,b as e,l as F,aa as v,q as N,B as L,a2 as U,Q as j,ab as u,H as B,ac as f}from"./vendor.9c0f602b.js";import{a as h}from"./staffApi.7c8dbe0f.js";import"./index.c7bb2c58.js";function k(){const n=t.exports.useRef(null),[o,i]=t.exports.useState([]),[g,c]=t.exports.useState(!1),[r,d]=t.exports.useState(0),[x,p]=t.exports.useState(),[y,w]=t.exports.useState(),m=async()=>{p(!0);const a=await h.lastUploadDate();if(p(!1),!a.ok)return console.log("Error in fetching the last upload date and time",a.data.data);w(a.data.data.upload_date)};t.exports.useEffect(()=>{m()},[]);const D=async()=>{const a=new FormData;a.append("excelFile",new Blob(o,{type:"application/json"})),d(0),c(r);const s=await h.importExcelToDB(a,b=>d(b));return c(!1),console.log("response",s.data),s.data.success?(n.current.removeFiles(),i([]),m(),f.fire({icon:"success",title:"Success",text:s.data.message})):f.fire({title:"Error!!!",text:s.data.message})};return l("div",{children:[l(S,{style:{padding:10},children:[e(F.Label,{className:"mt-3",children:"Upload Excel files here"}),e(v,{ref:n,className:"mt-3 mb-3",allowMultiple:!0,maxFiles:50,name:"excelFile",onupdatefiles:a=>{i(a.map(s=>s.file))}}),e("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:e(N,{sm:6,md:2,className:"mg-t-10 mg-sm-t-0 justify-center",children:e(L,{variant:"primary",className:"btn-block",disabled:o.length===0,onClick:D,children:"Upload"})})})]}),e("div",{style:{display:"flex",justifyContent:"center"},children:l(U,{variant:"primary",style:{padding:5,alignSelf:"center"},children:["Last Update Date:",x?e(j,{animation:"grow",className:"",role:"status",children:e("span",{className:"sr-only",children:"Loading..."})}):new Date(y).toLocaleString()]})}),e(u,{show:g,backdrop:"static",centered:!0,children:l(u.Body,{className:"text-center p-2 pb-0",children:[e("h4",{style:{textAlign:"center"},children:"Progress (%)"}),e(B,{className:"h-8",variant:"primary",now:r*100,label:`${(r*100).toFixed(2)}%`}),e("div",{style:{margin:10},children:e("h6",{children:"Please wait..."})})]})})]})}export{k as default};
