import{M as L,R as O,b as e,E as U,r as s,k as G,j as a,F as W,l as z,T as V,n as j,o as S,p as P,q as f,s as C,B as E,Y as $,x as H,y as X,z as Y,G as J,aa as K,J as Q,X as Z}from"./vendor.daf4729c.js";import{d as ee,u as te,b as ae}from"./index.142592eb.js";/* empty css              */import{a as oe}from"./staffApi.560af7a2.js";L.setAppElement("body");const le=({staff_id:o,staff_name:n,title:c})=>a(W,{children:[a("div",{style:{display:"flex",justifyContent:"space-between"},children:[a("div",{style:{display:"flex",alignItems:"center"},children:[e("div",{style:{width:40,height:40,borderRadius:20,backgroundColor:"lightblue",marginRight:5,whiteSpace:"nowrap",flexShrink:0},children:e("img",{src:`${te.baseUrl1}api/lecturer/image/${o}`,style:{width:40,height:40,borderRadius:20,backgroundColor:"lightblue",marginRight:5,whiteSpace:"nowrap",flexShrink:0}})}),a("div",{children:[e("div",{style:{fontSize:13},children:`${c} ${n}`}),e("div",{style:{fontSize:12,opacity:.8},children:`${o}`})]})]}),e("span",{style:{color:"purple",fontWeight:"bolder",fontSize:20},children:""})]}),e("hr",{style:{margin:5}})]});O.memo(()=>e("div",{style:{whiteSpace:"nowrap",overflowX:"auto"},children:e(U,{className:"chartsh",option:{tooltip:{trigger:"axis",axisPointer:{type:"line"}},grid:{top:"6",right:"0",bottom:"17",left:"25"},xAxis:[{type:"category",align:"center",axisLabel:{show:!0,formatter:function(n,c){return ne(n,15)}},data:["Business Communication","Computer Maths","Structured Programming","Artificial Intelligence","Computer Repair"]}],yAxis:[{type:"value"}],series:[{name:"Taught Percentage",type:"bar",stack:"Stack",barMaxWidth:20,color:"#285cf7",emphasis:{focus:"series"},data:[10,15,9,18,10,15]},{name:"Not Taught",type:"bar",stack:"Stack",barMaxWidth:20,color:"#f7557a",emphasis:{focus:"series"},data:[10,14,10,15,9,25]}]},height:"150px",style:{whiteSpace:"nowrap",overflowX:"auto"}})}));function ne(o,n){return o.length>n?o.slice(0,n-3)+"...":o}const se=O.memo(({data:o,yr:n,selectedDate:c})=>{const[h,b]=s.exports.useState(!1);s.exports.useState(!1);const[_,M]=s.exports.useState([]),[u,y]=s.exports.useState(0),[I,R]=s.exports.useState(""),[r,k]=s.exports.useState(null),[N,A]=s.exports.useState(null),[D,v]=s.exports.useState(!1),[B,m]=s.exports.useState([]),w=[{header:"#",accessorFn:t=>t.room_data.ed_id},{header:"Room",accessorFn:t=>t.room_data.room_name},{header:"Session",accessorFn:t=>t.room_data.session_name},{header:"Total Course Units",accessorFn:t=>t,cell:t=>e("span",{children:t.getValue().examsDidInRoom?t.getValue().examsDidInRoom.totalModules:0})},{header:"Total stds Scanned",accessorFn:t=>t,cell:t=>e("span",{children:t.getValue().examsDidInRoom?t.getValue().examsDidInRoom.totalStudents:0})},{header:"Status",accessorFn:t=>t,cell:t=>e("div",{style:{backgroundColor:t.getValue().room_data.started_at&&t.getValue().room_data.ended_at?"green":t.getValue().room_data.started_at&&!t.getValue().room_data.ended_at?"orange":"gray",display:"flex",justifyContent:"center",alignItems:"center",borderRadius:15,padding:2},children:e("span",{style:{color:"#fff",textAlign:"center",fontWeight:"bold"},children:t.getValue().room_data.started_at&&t.getValue().room_data.ended_at?"Ended":t.getValue().room_data.started_at&&!t.getValue().room_data.ended_at?"Ongoing":"Not Started"})})},{header:"Action",accessorFn:t=>t,cell:t=>e("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:e("i",{class:"bi bi-eye-fill",style:{color:"blue",fontSize:20,cursor:"pointer",textAlign:"center"},onClick:()=>{b(!0),console.log("the row",t.getValue()),k(t.getValue())}})})}],p=async t=>{v(!0);const g=await oe.getStudentsInCU(t);if(v(!1),!g.ok)return alert("Failed to load students");m(g.data.result),console.log("response",g.data)},l=G({columns:w,data:o,getCoreRowModel:H(),getPaginationRowModel:X(),getSortedRowModel:Y(),getFilteredRowModel:J(),state:{sorting:_,globalFilter:I},onSortingChange:M,onGlobalFilterChange:R}),q=()=>{const t=l.getPageCount(),g=10,i=[];if(t<=g)for(let d=0;d<t;d++)i.push(e(S.Item,{active:u===d,onClick:()=>{l.setPageIndex(d),y(d)},children:d+1},d));else{const d=Math.max(u-Math.floor(g/2),0),F=Math.min(d+g-1,t-1);d>0&&i.push(e(S.Ellipsis,{onClick:()=>{l.setPageIndex(0),y(0)}},"start-ellipsis"));for(let x=d;x<=F;x++)i.push(e(S.Item,{active:u===x,onClick:()=>{l.setPageIndex(x),y(x)},children:x+1},x));F<t-1&&i.push(e(S.Ellipsis,{onClick:()=>{l.setPageIndex(l.getPageCount()-1),y(l.getPageCount()-1)}},"end-ellipsis"))}return i};return a(W,{children:[e("div",{style:{display:"flex",justifyContent:"flex-end",width:400},children:e(z.Control,{className:"mb-2 mg-b-10",style:{alignSelf:"flex-end"},type:"text",value:I,onChange:t=>{R(t.target.value)},placeholder:"Search"})}),a(V,{responsive:!0,bordered:!0,hover:!0,style:{padding:0,marginBottom:0},children:[e("thead",{style:{position:"sticky",top:0,zIndex:1},children:l.getHeaderGroups().map((t,g)=>e("tr",{style:{backgroundColor:"lightblue",borderBottomColor:"blue",borderBottomWidth:5},children:t.headers.map((i,d)=>a("th",{onClick:i.column.getToggleSortingHandler(),style:{cursor:"pointer",position:"sticky",top:0,zIndex:1e3},children:[j(i.column.columnDef.header,i.getContext()),e("span",{children:{asc:e("i",{style:{},className:"fa fa-angle-up"}),desc:e("i",{style:{},className:"fa fa-angle-down"})}[i.column.getIsSorted()??null]})]}))},g))}),e("tbody",{style:{padding:0,maxHeight:100,overflowY:"auto",position:"relative"},children:l.getRowModel().rows.length!==0?l.getRowModel().rows.map((t,g)=>e("tr",{onDoubleClick:()=>{b(!0),console.log("the row",t.original),k(t.original)},children:t.getVisibleCells().map((i,d)=>e("td",{style:{padding:i.column.columnDef.header==="Staff"?5:null},children:j(i.column.columnDef.cell,i.getContext())},d))},g)):e("tr",{style:{alignSelf:"center"},children:e("td",{style:{textAlign:"center"},colSpan:6,children:a("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e("img",{src:ee,alt:"",className:"wd-15p"}),e("h5",{className:"mg-b-10 mg-t-15 tx-18",children:"No Data Available"})]})})})})]}),e("div",{style:{marginTop:10,display:"flex",justifyContent:"flex-end"},children:a(S,{className:"mb-0",children:[e(S.Prev,{disabled:u===0,onClick:()=>{l.previousPage(),y(u-1)}}),q(),e(S.Next,{disabled:u===l.getPageCount()-1,onClick:()=>{l.nextPage(),y(u+1)}})]})}),r&&e("div",{children:a(L,{isOpen:h,style:{overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)"},content:{position:"absolute",border:"1px solid #ccc",background:"#ecf0fa",overflow:"hidden",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none"}},contentLabel:"Example Modal",children:[a(P,{style:{marginTop:25},children:[e(f,{md:3,children:a(C,{style:{padding:15},children:[a("h4",{style:{textAlign:"center",fontWeight:"bold"},children:[r.room_data.room_name," -"," ",r.room_data.session_name," ","SESSION"]}),e("div",{style:{display:"flex",justifyContent:"center"},children:e("div",{style:{backgroundColor:r.room_data.started_at&&r.room_data.ended_at?"green":r.room_data.started_at&&!r.room_data.ended_at?"orange":"gray",display:"flex",justifyContent:"center",alignItems:"center",borderRadius:15,padding:2,width:100},children:e("span",{style:{color:"#fff",textAlign:"center",fontWeight:"bold",fontStyle:"italic"},children:r.room_data.started_at&&r.room_data.ended_at?"Ended":r.room_data.started_at&&!r.room_data.ended_at?"Ongoing":"Not Started"})})}),e("hr",{}),a("div",{style:{height:"calc(100vh - 300px)",overflow:"auto"},children:[e("h5",{children:"Courseunits in room"}),e("div",{style:{overflow:"auto"},children:r.examsDidInRoom?r.examsDidInRoom.students.map(t=>a("div",{onClick:async()=>{console.log("clicked...",t),await p(t.id),A(t)},style:{backgroundColor:N&&N.id==t.id?"lightgray":"#e9eeee",display:"flex",justifyContent:"space-between",alignItems:"center",padding:10,borderRadius:10,marginBottom:10,cursor:"pointer"},children:[e("span",{style:{fontWeight:"bold"},children:t.module_title}),e("span",{style:{color:"purple",fontWeight:"bolder",fontSize:16},children:t.studentCount})]})):e("h4",{style:{textAlign:"center"},children:"No course units found"})})]})]})}),e(f,{children:a(C,{children:[a("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:10},children:[e("div",{children:e("h5",{style:{margin:0,padding:0},children:"Students scanned "})}),e("div",{style:{display:"flex",justifyContent:"space-between",width:"auto"},children:e(E,{style:{alignSelf:"center",marginLeft:10,padding:10,paddingTop:5,paddingBottom:5},disabled:!0,children:"Export"})})]}),e("hr",{style:{padding:0,margin:0}}),e("div",{style:{height:"calc(100vh - 230px)",overflow:"auto"},children:a(V,{children:[a("thead",{style:{position:"sticky",top:0,backgroundColor:"#f1f1f1"},children:[e("th",{style:{padding:5},children:"#"}),e("th",{children:"Student Name"}),e("th",{children:"Student No"}),e("th",{children:"Booklet No"}),e("th",{children:"Handed In"})]}),e("tbody",{style:{minHeight:300},children:D?e("tr",{style:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",top:150,left:300},children:e($,{animation:"border",size:"lg",className:"",role:"status","aria-hidden":"true",children:e("span",{className:"sr-only",children:"Loading..."})})}):B.map((t,g)=>a("tr",{style:{color:t.handed_in?"blue":"red"},children:[e("td",{children:g+1}),e("td",{children:t.name}),e("td",{children:t.stu_no}),e("td",{children:t.booklet_no}),e("td",{children:t.handed_in?e("i",{class:"bi bi-check-lg"}):e("i",{class:"bi bi-x-lg"})})]}))})]})})]})}),e(f,{md:3,children:a(C,{style:{padding:15},children:[e("h5",{children:"Assigned Invigilators"}),e("div",{style:{height:"calc(100vh - 240px)"},children:r.otherInvigilators.map(t=>e(le,{staff_id:t.staff_id,staff_name:t.staff_name,title:t.title}))})]})})]}),e("button",{style:{position:"absolute",top:10,right:10},onClick:()=>{b(!1),m([])},children:"close"})]})})]})}),re=[{value:"1",label:"MAIN"},{value:"2",label:"KAMPALA"}];function ie(o){const n=o.split("/"),c=n[2],h=n[0].padStart(2,"0"),b=n[1].padStart(2,"0");return`${c}-${h}-${b}`}const de=o=>{const n=o.map(h=>h.room_data),c=new Set;return n.forEach(h=>{c.add(h.room_id)}),c.size},T=({title:o,backgroundColor:n,total:c,onClick:h})=>e(C,{className:`overflow-hidden sales-card ${n}`,style:{cursor:"pointer"},onClick:h,children:a("div",{className:"px-3 pt-2 pb-1 pt-0",children:[e("div",{style:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2},children:e("h6",{className:"tx-12 text-white",children:o})}),e("div",{className:"pb-0 mt-0",children:e("div",{className:"d-flex",children:e("div",{className:"",children:e("h4",{className:"tx-20 fw-bold mb-1 text-white",children:c})})})})]})});function me(){const o=s.exports.useRef(null),[n,c]=s.exports.useState(!1),[h,b]=s.exports.useState(new Date),[_,M]=s.exports.useState(),[u,y]=s.exports.useState([]),[I,R]=s.exports.useState(0),[r,k]=s.exports.useState(0),[N,A]=s.exports.useState(0);let D=0,v=0;return a("div",{children:[e(K,{ref:o}),e("div",{style:{marginBottom:20},children:e("h4",{className:"tx-24",children:"Examination Report"})}),e("div",{children:e(z,{onSubmit:async m=>{m.preventDefault();let w={campus:_.label,date:ie(new Date(h).toLocaleDateString())};c(!0);const p=await ae.load_assigned_rooms(w);if(c(!1),!p.ok)return o.current.show({severity:"error",summary:"Error",detail:"Failed to load examination rooms",life:3e3});console.log("the response",p.data.result),p.data.result.map(l=>{l.examsDidInRoom&&(D+=l.examsDidInRoom.totalStudents),l.otherInvigilators&&(v+=l.otherInvigilators.length)}),k(D),A(v),y(p.data.result),R(de(p.data.result)),o.current.show({severity:"success",summary:"Success",detail:p.data.message?p.data.message:"Rooms loaded successfully",life:3e3})},children:a(P,{className:"row-sm center",style:{marginBottom:20},children:[a(f,{lg:2,children:[e("label",{className:"lb",children:"Campus"}),e(Q,{classNamePrefix:"Select-sm",required:!0,value:_,onChange:m=>M(m),options:re,placeholder:"Campus"})]}),a(f,{lg:2,children:[e("label",{className:"lb",children:"Date"}),e("br",{}),e("div",{style:{marginBottom:2}}),e("div",{children:e(Z,{required:!0,selected:h,onChange:m=>{const w=new Date(m).getFullYear()+"-"+(new Date(m).getMonth()+1)+"-"+new Date(m).getDate();b(new Date(w))},dateFormat:"yyyy-MM-dd",className:"form-control date-picker",popperClassName:"date-popper"})})]}),e(f,{lg:1,style:{display:"flex",justifyContent:"flex-end"},children:e(E,{type:"submit",style:{alignSelf:"flex-end",width:"100%",marginBottom:3,padding:10,paddingTop:5,paddingBottom:5},children:n?e($,{animation:"border",size:"sm",className:"",role:"status","aria-hidden":"true",children:e("span",{className:"sr-only",children:"Loading..."})}):"Load"})})]})})}),a(P,{children:[e(f,{md:9,children:a(C,{style:{boxShadow:"none",borderColor:"lightgray",borderWidth:1,padding:0},children:[a("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:10},children:[e("div",{children:e("h5",{style:{margin:0,padding:0},children:"Rooms"})}),e("div",{style:{display:"flex",justifyContent:"space-between",width:"auto"},children:e(E,{style:{alignSelf:"center",marginLeft:10,padding:10,paddingTop:5,paddingBottom:5},disabled:!0,children:"Export"})})]}),e("hr",{style:{padding:0,margin:0}}),e(C.Body,{style:{padding:10},children:e(se,{data:u,yr:null,selectedDate:null})})]})}),e(f,{children:a(C,{style:{boxShadow:"none",borderColor:"lightgray",borderWidth:1,padding:10,paddingTop:20},children:[e(T,{title:"TOTAL ROOMS",total:I,backgroundColor:"bg-success-gradient"}),e(T,{title:"TOTAL SESSIONS",total:u.length,backgroundColor:"bg-info-gradient"}),e(T,{title:"TOTAL STUDENTS SCANNED",total:r,backgroundColor:"bg-danger-gradient"}),e(T,{title:"TOTAL INVIGILATORS ASSIGNED",total:N,backgroundColor:"bg-warning-gradient"})]})})]}),e("div",{})]})}export{me as default};
